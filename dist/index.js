// Generated by CoffeeScript 1.10.0
(function() {
  var Being, PORT, adam, beingSchema, config, db, http, mongoose;

  http = require('http');

  mongoose = require('mongoose');

  config = require('./config');

  PORT = 8080;

  beingSchema = mongoose.Schema({
    first_name: String,
    last_name: String,
    age: Number
  });

  beingSchema.methods.ageOneYear = function() {
    this.age += 1;
    console.log('aging');
    return this.first_name + " is now " + this.age;
  };

  Being = mongoose.model('being', beingSchema);

  adam = new Being({
    first_name: 'Adam',
    last_name: 'Man',
    age: 1
  });

  mongoose.connect(config.creds.mongodb_uri);

  db = mongoose.connection;

  db.on('error', console.error.bind(console, 'connection error:'));

  db.once('open', function(callback) {});

  http.createServer(function(request, response) {
    request.resume();
    request.on('end', function() {
      console.log('request end');
      response.writeHead(200, {
        'Content-Type': 'text/plain'
      });
      response.end(adam.ageOneYear());
    });
  }).listen(PORT);

}).call(this);
